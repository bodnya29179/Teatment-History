<h2>{{ 'visitsHistory' | translate }}</h2>

<input style="padding: 10px" type="text" [formControl]="searchControl" [placeholder]="'visit.search' | translate">

@if (visits$ | async; as visits) {
  @if (visits.length) {
    <table>
      <thead>
        <tr>
          <th style="cursor:pointer;" (click)="changeSortOption('by-date')">
            @if (sortOptionControl.value === 'by-date') {
              {{ sortDirectionControl.value === 'asc' ? '⬆' : '⬇' }}
            }
            {{ 'visit.date' | translate }}
          </th>

          <th style="cursor:pointer;" (click)="changeSortOption('by-doctor')">
            @if (sortOptionControl.value === 'by-doctor') {
              {{ sortDirectionControl.value === 'asc' ? '⬆' : '⬇' }}
            }
            {{ 'visit.doctor' | translate }}
          </th>

          <th style="cursor:pointer;" (click)="changeSortOption('by-address')">
            @if (sortOptionControl.value === 'by-address') {
              {{ sortDirectionControl.value === 'asc' ? '⬆' : '⬇' }}
            }
            {{ 'visit.place' | translate }}
          </th>

          <th></th>
        </tr>
      </thead>

      <tbody>
        @for (visit of visits; track visit.id) {
          <tr>
            <td>{{ visit.date | date : 'longDate' : '' : currentLanguage }}</td>

            <td>
              {{ ('doctorTypes.' + visit.doctorType) | translate }}

              @if (visit.doctorName) {
                - {{ visit.doctorName }}
              }
            </td>

            <td>{{ visit.address }}</td>

            <td>
              <button (click)="showDetails(visit.id)">{{ 'visit.seeDetails' | translate }}</button>
            </td>
          </tr>
        }
      </tbody>
    </table>
  } @else {
    @if (searchControl.value) {
      {{ 'noMatches' | translate }}
    } @else {
      {{ 'emptyHistory' | translate }}
    }
  }
}
